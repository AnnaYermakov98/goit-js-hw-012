{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\n\nconst keyId = '32552782-0d4c86680018457e820f20492';\nconst BASE_URL = 'https://pixabay.com/api/';\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\n\nexport const fetchPhotos = async (searchedQuery, page = 1) => {\n    const urlParams = new URLSearchParams({\n        key: keyId,\n        q: searchedQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: 15,\n      });\n\n      const response = await axios.get(`${BASE_URL}?${urlParams}`);\n      totalHits = response.data.totalHits;\n      return response.data;\n    }\n// console.log(urlParams);\n//       return fetch(`${BASE_URL}?${urlParams}`).then(response => {\n//         if (!response.ok) {\n//           throw new Error(response.status);\n//         }\n//         return response.json();\n//     });\n// ","const gallery = document.querySelector('.gallery');\n\nexport function renderGallery(images) {\n\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\">\n                <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\">\n            </a>\n            <div class=\"info\">\n            <ul class=\"info-list\">\n            <li class=\"info-item\">\n            <p class=\"item-title\">Likes</p>\n            <p class=\"item-text\">${likes}</p></li>\n            <li class=\"info-item\"> \n            <p class=\"item-title\">Views</p>\n            <p class=\"item-text\">${views}</p></li>\n            <li class=\"info-item\">\n            <p class=\"item-title\">Comments</p>\n            <p class=\"item-text\">${comments}</p></li>\n            <li class=\"info-item\">\n            <p class=\"item-title\">Downloads</p>\n            <p class=\"item-text\">${downloads}</p></li>\n            </ul>\n            </div>\n        </li>\n    `).join('');\n\n    gallery.insertAdjacentHTML('beforeend', markup);\n}\n","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport axios from 'axios';\n\nimport {fetchPhotos} from './js/pixabay-api';\nimport {renderGallery} from './js/render-functions';\n\nconst gallery = document.querySelector('.gallery');\nconst form = document.querySelector('.form');\nconst loadMoreBtn = document.querySelector('.load-more');\nform.addEventListener('submit', submitHandler);\nloadMoreBtn.addEventListener('click', loadMorePhotos);\n\n\nconst lightBox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nasync function submitHandler(e) {\n    e.preventDefault();\n    currentQuery = e.target.elements.searchField.value.toLowerCase().trim();\n  \n    if (!currentQuery) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, you have to type something in the search field. Please try again!',\n        position: 'topRight',\n      });\n      return;\n    }\n    clearGallery();\n    currentPage = 1;\n    await getPhotos();\n  }\n\n\nasync function loadMorePhotos() {\n  currentPage += 1;\n  await getPhotos();\n}\n\nasync function getPhotos() {\n  try {\n    const data = await fetchPhotos(currentQuery, currentPage);\n    totalHits = data.totalHits;\n    if (data.hits.length === 0 && currentPage === 1) {\n      iziToast.warning({\n        title: 'Warning',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n    });\n    return;\n    }\n    renderGallery(data.hits);\n    loadMoreBtn.style.display = 'block';\n\n    if(currentPage * 15 >= totalHits) {\nloadMoreBtn.style.display = 'none';\niziToast.warning({\n  title: 'Warning',\n  message: 'Were sorry, but you have reached the end of search results',\n  position: 'topRight',\n});\n    }\n    const { height: cardHeight } = document.querySelector('.gallery-item').getBoundingClientRect();\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n    });\n} catch (error) {\n    handleError(error);\n}\n  }\n\n\n  function handleError(error) {\n    iziToast.error({\n      title: 'Error',\n      message: error.message || 'Something went wrong. Please try again later.',\n      position: 'topRight',\n    });\n  }\n  \n  // Функция для очистки галереи (определите эту функцию, если её еще нет)\n  function clearGallery() {\n    gallery.innerHTML = ''; // Очищаем содержимое галереи\n  }\n\n\n\n//     fetchPhotos(query)\n//         .then(data => {\n//             console.log(data.hits);\n//             if (data.hits.length === 0) {\n//                 iziToast.warning({\n//                     title: 'Warning',\n//                     message: 'Sorry, there are no images matching your search query. Please try again!',\n//                     position: 'topRight',\n//                 });\n//                 return;\n//             } \n//             renderGallery(data.hits);\n//             lightBox.refresh(); \n//         })\n//         .catch(error => {\n//             console.error('Error fetching photos:', error);\n//             iziToast.error({\n//                 title: 'Error',\n//                 message: 'An error occurred while fetching images. Please try again later.',\n//                 position: 'topRight',\n//             });\n//         });\n// }\n"],"names":["keyId","BASE_URL","fetchPhotos","searchedQuery","page","urlParams","response","gallery","renderGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","loadMoreBtn","submitHandler","loadMorePhotos","SimpleLightbox","e","iziToast","clearGallery","getPhotos","data","cardHeight","error","handleError"],"mappings":"6vBAEA,MAAMA,EAAQ,qCACRC,EAAW,2BAMJC,EAAc,MAAOC,EAAeC,EAAO,IAAM,CAC1D,MAAMC,EAAY,IAAI,gBAAgB,CAClC,IAAKL,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMC,EACN,SAAU,EAClB,CAAO,EAEKE,EAAW,MAAM,MAAM,IAAI,GAAGL,CAAQ,IAAII,CAAS,EAAE,EAC/C,OAAAC,EAAS,KAAK,UACnBA,EAAS,IACjB,ECvBCC,EAAU,SAAS,cAAc,UAAU,EAE1C,SAASC,EAAcC,EAAQ,CAElC,MAAMC,EAASD,EAAO,IAAI,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAAK;AAAA;AAAA,uBAErFL,CAAa;AAAA,gDACYD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAMvCC,CAAK;AAAA;AAAA;AAAA,mCAGLC,CAAK;AAAA;AAAA;AAAA,mCAGLC,CAAQ;AAAA;AAAA;AAAA,mCAGRC,CAAS;AAAA;AAAA;AAAA;AAAA,KAIvC,EAAE,KAAK,EAAE,EAEVV,EAAQ,mBAAmB,YAAaG,CAAM,CAClD,CCjBA,MAAMH,EAAU,SAAS,cAAc,UAAU,EAC3CW,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAc,SAAS,cAAc,YAAY,EACvDD,EAAK,iBAAiB,SAAUE,CAAa,EAC7CD,EAAY,iBAAiB,QAASE,CAAc,EAGnC,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,IACd,eAAgB,EAClB,CAAC,EAED,eAAeF,EAAcG,EAAG,CAI5B,GAHAA,EAAE,eAAc,EAChB,aAAeA,EAAE,OAAO,SAAS,YAAY,MAAM,cAAc,OAE7D,CAAC,aAAc,CACjBC,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,UAClB,CAAO,EACD,MACD,CACDC,IACA,YAAc,EACd,MAAMC,EAAS,CAChB,CAGH,eAAeL,GAAiB,CAC9B,aAAe,EACf,MAAMK,EAAS,CACjB,CAEA,eAAeA,GAAY,CACzB,GAAI,CACF,MAAMC,EAAO,MAAMzB,EAAY,aAAc,WAAW,EAExD,GADA,UAAYyB,EAAK,UACbA,EAAK,KAAK,SAAW,GAAK,cAAgB,EAAG,CAC/CH,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,2EACT,SAAU,UAClB,CAAK,EACD,MACC,CACDhB,EAAcmB,EAAK,IAAI,EACvBR,EAAY,MAAM,QAAU,QAEzB,YAAc,IAAM,YAC3BA,EAAY,MAAM,QAAU,OAC5BK,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,6DACT,SAAU,UACZ,CAAC,GAEG,KAAM,CAAE,OAAQI,GAAe,SAAS,cAAc,eAAe,EAAE,wBACvE,OAAO,SAAS,CACZ,IAAKA,EAAa,EAClB,SAAU,QAClB,CAAK,CACL,OAASC,EAAO,CACZC,EAAYD,CAAK,CACrB,CACG,CAGD,SAASC,EAAYD,EAAO,CAC1BL,EAAS,MAAM,CACb,MAAO,QACP,QAASK,EAAM,SAAW,gDAC1B,SAAU,UAChB,CAAK,CACF,CAGD,SAASJ,GAAe,CACtBlB,EAAQ,UAAY,EACrB"}